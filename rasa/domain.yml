# ============================================================================
# RASA DOMAIN CONFIGURATION
# D√©finition des intents, entities, slots, actions et responses
# ============================================================================

version: "3.1"

# ============================================================================
# INTENTS - Intentions utilisateur d√©tect√©es par le NLU
# ============================================================================
intents:
  # --- Intents de base ---
  - greet                    # Salutations
  - goodbye                  # Au revoir
  - affirm                   # Confirmation (oui)
  - deny                     # N√©gation (non)
  - mood_great               # Bonne humeur
  - mood_unhappy             # Mauvaise humeur
  - bot_challenge            # Test si bot ou humain
  - thank                    # Remerciements
  
  # --- Intents m√©tier (exemples Sofrecom) ---
  - ask_services             # Demande sur les services
  - ask_contact              # Demande de contact
  - ask_pricing              # Questions sur les tarifs
  - ask_support              # Demande de support technique
  - ask_hours                # Horaires d'ouverture
  - ask_location             # Localisation/adresse
  - ask_faq                  # Questions fr√©quentes g√©n√©rales
  - ask_product_info         # Informations produit
  - ask_documentation        # Demande de documentation
  - make_complaint           # Faire une r√©clamation
  - request_callback         # Demande de rappel
  - ask_human_agent          # Demande d'agent humain
  
  # --- Intent sp√©cial pour RAG ---
  - out_of_scope             # Questions hors scope (trigger RAG)
  - nlu_fallback             # Fallback NLU (confiance < seuil)

# ============================================================================
# ENTITIES - Entit√©s extraites des messages
# ============================================================================
entities:
  - person                   # Nom de personne
  - organization             # Nom d'organisation
  - location                 # Lieu
  - email                    # Adresse email
  - phone_number             # Num√©ro de t√©l√©phone
  - product_name             # Nom de produit
  - service_type             # Type de service
  - date                     # Date
  - time                     # Heure
  - amount                   # Montant
  - ticket_number            # Num√©ro de ticket

# ============================================================================
# SLOTS - Variables de session
# ============================================================================
slots:
  # Informations utilisateur
  user_name:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: person
        
  user_email:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: email
        
  user_phone:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: phone_number
        
  # Contexte de la conversation
  current_topic:
    type: categorical
    values:
      - services
      - support
      - pricing
      - general
    influence_conversation: true
    mappings:
      - type: custom
        
  # Confiance NLU pour le routing
  nlu_confidence:
    type: float
    influence_conversation: false
    mappings:
      - type: custom
        
  # R√©ponse RAG stock√©e
  rag_response:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
        
  # Contexte RAG r√©cup√©r√©
  rag_context:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
        
  # Feedback utilisateur
  user_feedback:
    type: categorical
    values:
      - positive
      - negative
      - neutral
    influence_conversation: false
    mappings:
      - type: custom

  # Ticket support
  ticket_number:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: ticket_number

# ============================================================================
# RESPONSES - R√©ponses du bot (templates)
# ============================================================================
responses:
  # --- R√©ponses de base ---
  utter_greet:
    - text: "Bonjour ! Je suis l'assistant virtuel Sofrecom. Comment puis-je vous aider aujourd'hui ?"
    - text: "Bienvenue ! Je suis l√† pour r√©pondre √† vos questions. Que puis-je faire pour vous ?"
    - text: "Salut ! Comment puis-je vous assister ?"
      
  utter_goodbye:
    - text: "Au revoir ! N'h√©sitez pas √† revenir si vous avez d'autres questions."
    - text: "√Ä bient√¥t ! Passez une excellente journ√©e."
    - text: "Merci de votre visite. √Ä la prochaine !"
      
  utter_iamabot:
    - text: "Je suis un assistant virtuel propuls√© par l'intelligence artificielle. Je suis l√† pour vous aider !"
      
  utter_happy:
    - text: "Super ! Je suis ravi de pouvoir vous aider. üòä"
    - text: "Parfait ! Y a-t-il autre chose que je peux faire pour vous ?"
      
  utter_cheer_up:
    - text: "Je suis d√©sol√© d'entendre √ßa. üòî Voici quelque chose qui pourrait vous remonter le moral !"
      image: "https://i.imgur.com/nGF1K8f.jpg"
    - text: "Je comprends. Comment puis-je am√©liorer votre journ√©e ?"
      
  utter_did_that_help:
    - text: "Est-ce que ma r√©ponse vous a √©t√© utile ?"
    - text: "Ai-je pu r√©pondre √† votre question ?"
      
  utter_thank:
    - text: "Je vous en prie ! C'est un plaisir de vous aider."
    - text: "De rien ! N'h√©sitez pas si vous avez d'autres questions."
      
  # --- R√©ponses m√©tier ---
  utter_services:
    - text: |
        Nous proposons une gamme compl√®te de services :
        
        üìä **Conseil & Strat√©gie** - Accompagnement dans votre transformation digitale
        üíª **D√©veloppement** - Solutions sur mesure (web, mobile, API)
        ‚òÅÔ∏è **Cloud & Infrastructure** - Migration et gestion cloud
        üîí **Cybers√©curit√©** - Protection de vos donn√©es et syst√®mes
        üìà **Data & IA** - Exploitation intelligente de vos donn√©es
        
        Quel service vous int√©resse particuli√®rement ?
        
  utter_contact:
    - text: |
        Vous pouvez nous contacter de plusieurs fa√ßons :
        
        üìß **Email** : contact@sofrecom.com
        üìû **T√©l√©phone** : +33 1 XX XX XX XX
        üåê **Site web** : www.sofrecom.com
        üìç **Adresse** : [Adresse √† compl√©ter]
        
        Souhaitez-vous qu'un conseiller vous rappelle ?
        
  utter_pricing:
    - text: |
        Nos tarifs d√©pendent de plusieurs facteurs :
        - Type de service requis
        - Complexit√© du projet
        - Dur√©e de l'engagement
        
        Je vous invite √† contacter notre √©quipe commerciale pour obtenir un devis personnalis√©.
        Puis-je organiser un rendez-vous ?
        
  utter_support:
    - text: |
        Pour le support technique :
        
        üîß **Hotline** : +33 1 XX XX XX XX (24/7)
        üìß **Email support** : support@sofrecom.com
        üí¨ **Chat en direct** : Disponible sur notre site
        
        Avez-vous un num√©ro de ticket existant ?
        
  utter_hours:
    - text: |
        Nos horaires d'ouverture :
        
        üïê **Lundi - Vendredi** : 9h00 - 18h00
        üïê **Samedi** : 9h00 - 12h00
        üö´ **Dimanche** : Ferm√©
        
        Le support technique est disponible 24/7.
        
  utter_location:
    - text: |
        Notre si√®ge social :
        
        üìç **Adresse** : [Adresse compl√®te]
        üöá **M√©tro** : [Station la plus proche]
        üÖøÔ∏è **Parking** : Disponible sur place
        
        Souhaitez-vous un itin√©raire ?
        
  utter_ask_human:
    - text: |
        Je comprends que vous souhaitez parler √† un conseiller.
        
        Je peux :
        1. üìû Transf√©rer votre demande √† un agent
        2. üìÖ Planifier un rappel √† l'heure de votre choix
        
        Que pr√©f√©rez-vous ?
        
  utter_callback_confirm:
    - text: "Parfait ! Un conseiller vous rappellera dans les plus brefs d√©lais. Puis-je avoir votre num√©ro de t√©l√©phone ?"
    
  utter_complaint_received:
    - text: |
        Je suis d√©sol√© pour ce d√©sagr√©ment. Votre r√©clamation a √©t√© enregistr√©e.
        
        üìù **Num√©ro de suivi** : [G√©n√©r√© automatiquement]
        ‚è±Ô∏è **D√©lai de traitement** : 48-72h
        
        Un membre de notre √©quipe vous contactera rapidement.
        
  # --- R√©ponses fallback ---
  utter_default:
    - text: "Je ne suis pas s√ªr de comprendre. Pourriez-vous reformuler votre question ?"
    - text: "Hmm, je n'ai pas bien compris. Pouvez-vous pr√©ciser ?"
    
  utter_ask_rephrase:
    - text: "Je n'ai pas bien compris votre demande. Pourriez-vous la reformuler diff√©remment ?"
    
  utter_out_of_scope:
    - text: "Cette question d√©passe mon domaine d'expertise actuel. Laissez-moi chercher dans notre base de connaissances..."
    
  utter_rag_searching:
    - text: "Je recherche les informations pertinentes dans notre documentation..."
    
  utter_rag_no_answer:
    - text: |
        Je n'ai pas trouv√© d'information pr√©cise sur ce sujet dans notre documentation.
        
        Souhaitez-vous :
        1. Reformuler votre question ?
        2. Parler √† un conseiller humain ?

# ============================================================================
# ACTIONS - Actions custom (ex√©cut√©es par l'Action Server)
# ============================================================================
actions:
  # Actions RAG + LLM
  - action_rag_query              # Requ√™te RAG compl√®te
  - action_router                 # Router bas√© sur la confiance
  - action_check_confidence       # V√©rifie le score de confiance NLU
  
  # Actions m√©tier
  - action_create_ticket          # Cr√©er un ticket support
  - action_get_ticket_status      # Statut d'un ticket
  - action_request_callback       # Demander un rappel
  - action_log_conversation       # Logger la conversation
  - action_get_user_info          # R√©cup√©rer infos utilisateur
  - action_send_feedback          # Envoyer feedback
  
  # Actions syst√®me
  - action_session_start          # Initialisation session
  - action_default_fallback       # Fallback par d√©faut
  - action_restart                # Red√©marrer conversation

# ============================================================================
# FORMS - Formulaires de collecte d'informations
# ============================================================================
forms:
  # Formulaire de contact
  contact_form:
    required_slots:
      - user_name
      - user_email
      - user_phone
      
  # Formulaire de r√©clamation
  complaint_form:
    required_slots:
      - user_name
      - user_email

  # Formulaire de callback
  callback_form:
    required_slots:
      - user_name
      - user_phone

# ============================================================================
# SESSION CONFIGURATION
# ============================================================================
session_config:
  session_expiration_time: 60    # Minutes avant expiration
  carry_over_slots_to_new_session: true
